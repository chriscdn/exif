import t from"exifr";import{DateTime as e}from"luxon";import n from"tz-lookup";var i=t.parse,l=function(t){try{var l={latitude:null,longitude:null,timeZone:null,localTime:null,timestamp:null,timeZoneOffsetInMinutes:null,description:null,width:0,height:0,isPrecise:!1};return Promise.resolve(i(t,!0)).then(function(i){var o,r,u,a,s,h,f;l.latitude=null!=(o=i.latitude)?o:null,l.longitude=null!=(r=i.longitude)?r:null,l.latitude&&l.longitude&&(l.timeZone=n(l.latitude,l.longitude));var m=null!=(u=i.ImageDescription)?u:null;l.description=m?String(m).trim():null;var c,d,g,p=null!=(a=i.DateTimeOriginal)?a:null,v=null!=(s=i.OffsetTimeOriginal)?s:null;if((g=p)instanceof Date||"object"==typeof g&&"[object Date]"===Object.prototype.toString.call(g)){var w=l.timeZone,y=v?(c=v.split(":"),-(60*(d=parseInt(c[0]))+(d>0?1:-1)*parseInt(c[1]))):null;l.isPrecise=Boolean(w)||Boolean(y);var P=e.utc(p.getFullYear(),p.getMonth()+1,p.getDate(),p.getHours(),p.getMinutes(),p.getSeconds()).plus({minutes:null!=y?y:void 0}).setZone(null!=w?w:void 0,{keepLocalTime:void 0===y});l.timestamp=P.toMillis(),l.timeZoneOffsetInMinutes=y?-y:P.offset,l.localTime=P.toFormat("yyyy-MM-dd'T'HH:mm:ss")}l.width=null!=(h=i.ExifImageWidth)?h:null,l.height=null!=(f=i.ExifImageHeight)?f:null;var I=function(){if(!l.width&&!l.height){var e=function(){if("string"==typeof t)return Promise.resolve(import("probe-image-size")).then(function(e){return Promise.resolve((0,e.default)(t)).then(function(t){null!=t&&t.width&&null!=t&&t.height&&(l.width=t.width,l.height=t.height)})});var e=function(){if(window&&"string"!=typeof t)return Promise.resolve(function(t){try{return Promise.resolve(new Promise(function(e){var n=window.URL||window.webkitURL,i=new Image;i.onload=function(){e({width:i.width,height:i.height})},i.src=n.createObjectURL(t)}))}catch(t){return Promise.reject(t)}}(t)).then(function(t){l.width=t.width,l.height=t.height})}();return e&&e.then?e.then(function(){}):void 0}();if(e&&e.then)return e.then(function(){})}}();return I&&I.then?I.then(function(){return l}):l})}catch(t){return Promise.reject(t)}};export{l as default};
//# sourceMappingURL=exif.module.js.map
